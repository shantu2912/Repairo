<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FixZen Pro | Partner Login</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body class="min-h-screen flex items-center justify-center bg-[#F8F5F0]">

  <div class="bg-white p-10 rounded-3xl shadow-xl w-[360px]">
    <h1 class="text-2xl font-bold text-center mb-6">FixZen Pro</h1>

    <input
      id="name"
      placeholder="Your Name"
      class="w-full mb-4 p-3 border rounded-xl"
    />

    <input
      id="password"
      type="password"
      placeholder="Password"
      class="w-full mb-4 p-3 border rounded-xl"
    />

    <p id="error" class="text-red-600 text-sm mb-3 hidden"></p>

    <button
      onclick="login()"
      class="w-full bg-[#5D5646] text-white py-3 rounded-xl font-bold"
    >
      LOGIN
    </button>
  </div>

  <script>
    // ‚úÖ SUPABASE INIT (ONLY ONCE)
     supabase = window.supabase.createClient(
      "https://kzxdxnxgouthsywbsnvl.supabase.co",
       'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt6eGR4bnhnb3V0aHN5d2JzbnZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYzMTczMzIsImV4cCI6MjA4MTg5MzMzMn0.nqzn89vmTFKVNuZPHfGRxdTg6UHT6GMud238rr49qag'
    );

    async function login() {
      const name = document.getElementById("name").value.trim();
      const password = document.getElementById("password").value;
      const errorEl = document.getElementById("error");

      errorEl.classList.add("hidden");

      if (!name || !password) {
        showError("Enter name and password");
        return;
      }

      // üîí TEMP PASSWORD CHECK
      if (password !== "1234") {
        showError("Wrong password");
        return;
      }

      // üîç CHECK NAME EXISTS
      const { data, error } = await supabase
        .from("technicians")
        .select("*")
        .ilike("name", name)
        .single();

      if (error || !data) {
        showError("Partner not found");
        return;
      }

      // üöÄ SAVE SESSION
      localStorage.setItem("active_tech", JSON.stringify(data));

      // ‚û°Ô∏è REDIRECT
      window.location.href = "techniciandashboard.html";
    }

    function showError(msg) {
      const el = document.getElementById("error");
      el.innerText = msg;
      el.classList.remove("hidden");
    }
  </script>
</body>
</html>
